SQL> REM 14 - LOS NOMBRES Y TELEFONOS DE LOS SOCIOS QUE HAN ASISTIDO A CLASES DE MARIA
SQL> 
SQL> SELECT DISTINCT SOCIOS.NOMBRE, SOCIOS.TELEFONO FROM SOCIOS, ASISTIR, CLASES, PROFESORES WHERE SOCIOS.N_SOCIO=ASISTIR.N_SOCIO AND ASISTIR.ID_CLASE=CLASES.ID_CLASE AND CLASES.TIPO=PROFESORES.ESTILO AND PROFESORES.NOMBRE='MARIA';

NOMBRE               TELEFONO                                                   
-------------------- ----------                                                 
ALFONSO              360462957                                                  
OSCAR                355745640                                                  
ALBERTO              646503181                                                  
CARLOS               364814653                                                  
SUSANA               821403819                                                  
MERCEDES             848887557                                                  
TOMAS                660046009                                                  
JUAN                 227652163                                                  
MARTA                217954856                                                  
CARLA                793324108                                                  
MONICA               299217214                                                  

NOMBRE               TELEFONO                                                   
-------------------- ----------                                                 
JOSE LUIS            595711088                                                  
ALEXA                347186593                                                  
ENRIQUE              514378378                                                  
PAULA                604826822                                                  
MADELEINE            383638907                                                  

16 filas seleccionadas.

SQL> set linesize 800
SQL> set pagesize 800
SQL> SELECT DISTINCT SOCIOS.NOMBRE, SOCIOS.TELEFONO FROM SOCIOS, ASISTIR, CLASES, PROFESORES WHERE SOCIOS.N_SOCIO=ASISTIR.N_SOCIO AND ASISTIR.ID_CLASE=CLASES.ID_CLASE AND CLASES.TIPO=PROFESORES.ESTILO AND PROFESORES.NOMBRE='MARIA';

NOMBRE               TELEFONO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
-------------------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
ALFONSO              360462957                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
OSCAR                355745640                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
ALBERTO              646503181                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
CARLOS               364814653                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
SUSANA               821403819                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
MERCEDES             848887557                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
TOMAS                660046009                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
JUAN                 227652163                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
MARTA                217954856                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
CARLA                793324108                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
MONICA               299217214                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
JOSE LUIS            595711088                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
ALEXA                347186593                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
ENRIQUE              514378378                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
PAULA                604826822                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
MADELEINE            383638907                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  

16 filas seleccionadas.

SQL> 
SQL> REM 15 - LOS NOMBRES DE LOS SOCIOS QUE MµS ASISTIERON A CLASES DE MARIA
SQL> 
SQL> SELECT SOCIOS.NOMBRE, COUNT(SOCIOS.NOMBRE) N_VECES FROM SOCIOS, ASISTIR, CLASES, PROFESORES WHERE SOCIOS.N_SOCIO=ASISTIR.N_SOCIO AND ASISTIR.ID_CLASE=CLASES.ID_CLASE AND CLASES.TIPO=PROFESORES.ESTILO AND PROFESORES.NOMBRE='MARIA' GROUP BY SOCIOS.NOMBRE HAVING N_VECES=(SELECT MAX(COUNT(SOCIOS.NOMBRE)) FROM SOCIOS, ASISTIR, CLASES, PROFESORES WHERE SOCIOS.N_SOCIO=ASISTIR.N_SOCIO AND ASISTIR.ID_CLASE=CLASES.ID_CLASE AND CLASES.TIPO=PROFESORES.ESTILO AND PROFESORES.NOMBRE='MARIA' GROUP BY SOCIOS.NOMBRE);
SELECT SOCIOS.NOMBRE, COUNT(SOCIOS.NOMBRE) N_VECES FROM SOCIOS, ASISTIR, CLASES, PROFESORES WHERE SOCIOS.N_SOCIO=ASISTIR.N_SOCIO AND ASISTIR.ID_CLASE=CLASES.ID_CLASE AND CLASES.TIPO=PROFESORES.ESTILO AND PROFESORES.NOMBRE='MARIA' GROUP BY SOCIOS.NOMBRE HAVING N_VECES=(SELECT MAX(COUNT(SOCIOS.NOMBRE)) FROM SOCIOS, ASISTIR, CLASES, PROFESORES WHERE SOCIOS.N_SOCIO=ASISTIR.N_SOCIO AND ASISTIR.ID_CLASE=CLASES.ID_CLASE AND CLASES.TIPO=PROFESORES.ESTILO AND PROFESORES.NOMBRE='MARIA' GROUP BY SOCIOS.NOMBRE)
                                                                                                                                                                                                                                                                    *
ERROR en línea 1:
ORA-00904: "N_VECES": identificador no válido 


SQL> 
SQL> SELECT SOCIOS.NOMBRE, COUNT(SOCIOS.NOMBRE) FROM SOCIOS, ASISTIR, CLASES, PROFESORES WHERE SOCIOS.N_SOCIO=ASISTIR.N_SOCIO AND ASISTIR.ID_CLASE=CLASES.ID_CLASE AND CLASES.TIPO=PROFESORES.ESTILO AND PROFESORES.NOMBRE='MARIA' GROUP BY SOCIOS.NOMBRE HAVING COUNT(SOCIOS.NOMBRE)=(SELECT MAX(COUNT(SOCIOS.NOMBRE)) FROM SOCIOS, ASISTIR, CLASES, PROFESORES WHERE SOCIOS.N_SOCIO=ASISTIR.N_SOCIO AND ASISTIR.ID_CLASE=CLASES.ID_CLASE AND CLASES.TIPO=PROFESORES.ESTILO AND PROFESORES.NOMBRE='MARIA' GROUP BY SOCIOS.NOMBRE);

NOMBRE               COUNT(SOCIOS.NOMBRE)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
-------------------- --------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
ALFONSO                                 7                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
ALEXA                                   7                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
CARLA                                   7                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       

SQL> 
SQL> 
SQL> REM 15 - LOS NOMBRES DE LOS SOCIOS QUE MµS ASISTIERON A CLASES DE MARIA
SQL> 
SQL> SELECT SOCIOS.NOMBRE, COUNT(SOCIOS.NOMBRE) N_VECES FROM SOCIOS, ASISTIR, CLASES, PROFESORES WHERE SOCIOS.N_SOCIO=ASISTIR.N_SOCIO AND ASISTIR.ID_CLASE=CLASES.ID_CLASE AND CLASES.TIPO=PROFESORES.ESTILO AND PROFESORES.NOMBRE='MARIA' GROUP BY SOCIOS.NOMBRE HAVING N_VECES=(SELECT MAX(COUNT(SOCIOS.NOMBRE)) FROM SOCIOS, ASISTIR, CLASES, PROFESORES WHERE SOCIOS.N_SOCIO=ASISTIR.N_SOCIO AND ASISTIR.ID_CLASE=CLASES.ID_CLASE AND CLASES.TIPO=PROFESORES.ESTILO AND PROFESORES.NOMBRE='MARIA' GROUP BY SOCIOS.NOMBRE);
SELECT SOCIOS.NOMBRE, COUNT(SOCIOS.NOMBRE) N_VECES FROM SOCIOS, ASISTIR, CLASES, PROFESORES WHERE SOCIOS.N_SOCIO=ASISTIR.N_SOCIO AND ASISTIR.ID_CLASE=CLASES.ID_CLASE AND CLASES.TIPO=PROFESORES.ESTILO AND PROFESORES.NOMBRE='MARIA' GROUP BY SOCIOS.NOMBRE HAVING N_VECES=(SELECT MAX(COUNT(SOCIOS.NOMBRE)) FROM SOCIOS, ASISTIR, CLASES, PROFESORES WHERE SOCIOS.N_SOCIO=ASISTIR.N_SOCIO AND ASISTIR.ID_CLASE=CLASES.ID_CLASE AND CLASES.TIPO=PROFESORES.ESTILO AND PROFESORES.NOMBRE='MARIA' GROUP BY SOCIOS.NOMBRE)
                                                                                                                                                                                                                                                                    *
ERROR en línea 1:
ORA-00904: "N_VECES": identificador no válido 


SQL> 
SQL>  REM 16 - CORREO ELECTRàNICO Y NOMBRE COMPLETO DE TODOS LOS PROFESORES QUE DAN SPINNING EN LA SALA 5
SQL> 
SQL> SELECT PROFESORES.MAIL, PROFESORES.NOMBRE, PROFESORES.APELLIDO, PROFESORES.SEG_APELLIDO FROM DAR_SPINNING, DARSE, PROFESORES WHERE DARSE.N_SALA=5 AND DARSE.ID_CLASE=DAR_SPINNING.ID_CLASE AND DAR_SPINNING.N_PROFESOR=PROFESORES.N_PROFESOR;

MAIL                                                                                                 NOMBRE               APELLIDO             SEG_APELLIDO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
---------------------------------------------------------------------------------------------------- -------------------- -------------------- --------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
rmosquera@gmail.com                                                                                  ROCIO                MOSQUERA             HERRERO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          

SQL>  REM 16 - TELEFONO Y NOMBRE COMPLETO DE TODOS LOS PROFESORES QUE DAN SPINNING EN LA SALA 5
SQL> SELECT PROFESORES.TELEFONO, PROFESORES.NOMBRE, PROFESORES.APELLIDO, PROFESORES.SEG_APELLIDO FROM DAR_SPINNING, DARSE, PROFESORES WHERE DARSE.N_SALA=5 AND DARSE.ID_CLASE=DAR_SPINNING.ID_CLASE AND DAR_SPINNING.N_PROFESOR=PROFESORES.N_PROFESOR;

TELEFONO   NOMBRE               APELLIDO             SEG_APELLIDO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
---------- -------------------- -------------------- --------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
649349364  ROCIO                MOSQUERA             HERRERO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    

SQL> 
SQL> REM 17 - TODOS LOS CORREOS, TELFONOS Y NOMBRES COMPLETOS DE AQUELLOS QUE TENGAN GMAIL (POR UN ERROR EN EL SISTEMA)
SQL> 
SQL> select nombre, apellido, seg_apellido, mail from socios where mail like '%@gmail%' union all select nombre, apellido, seg_apellido, mail from profesores where mail like '%@gmail%';

NOMBRE               APELLIDO             SEG_APELLIDO         MAIL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
-------------------- -------------------- -------------------- ----------------------------------------------------------------------------------------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
TOMAS                VEGA                 ORTEGA               tvega@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
CARLOS               DA VINCI             PAVAROTTI            cdavinci@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
MARTA                SERRAT               SABINA               mserrat@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
CARLA                MESSI                RONALDO              cmessi@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
ALEXA                MARTINEZ             ORTEGA               amartinez@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
PAULA                EDERY                                     pedery@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
JUAN                 GARRIDO                                   jgarrido@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
DANIEL               NAVARRO              MONTERO              dnavarro@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
MARINA               DIAZ                 HERNANDO             mdiazhernando@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
ANGELA               OLIVA                JIMIENEZ             aoliva@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
HELENA               ROMAN                PULIDO               hroman@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
ROCIO                MOSQUERA             HERRERO              rmosquera@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
ELENA                MONTOYA              VILLEGAS             emontoya@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
MARIA                OSUNA                GALISTEO             mosuna@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
SERGIO               NAVAS                                     snavas@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
MANUEL               GALLEGO              HERRERA              mgallego@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
ALEJANDRO            ALONSO               ORIHUELA             aalonso@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
JULIA                MARTINEZ             ATIENZA              jatienza@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
LUCIA                ALVAR                ORTEGA               lalvar@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 

19 filas seleccionadas.

SQL> SELECT NOMBRE, APELLIDO, SEG_APELLIDO, MAIL FROM SOCIOS WHERE MAIL LIKE '@gmail%' UNION ALL SELECT NOMBRE, APELLIDO, SEG_APELLIDO, MAIL FROM PROFESORES WHERE MAIL LIKE '@gmail%';

ninguna fila seleccionada

SQL> SELECT NOMBRE, APELLIDO, SEG_APELLIDO, MAIL FROM SOCIOS WHERE MAIL LIKE '%@gmail%' UNION ALL SELECT NOMBRE, APELLIDO, SEG_APELLIDO, MAIL FROM PROFESORES WHERE MAIL LIKE '%@gmail%';

NOMBRE               APELLIDO             SEG_APELLIDO         MAIL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
-------------------- -------------------- -------------------- ----------------------------------------------------------------------------------------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
TOMAS                VEGA                 ORTEGA               tvega@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
CARLOS               DA VINCI             PAVAROTTI            cdavinci@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
MARTA                SERRAT               SABINA               mserrat@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
CARLA                MESSI                RONALDO              cmessi@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
ALEXA                MARTINEZ             ORTEGA               amartinez@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
PAULA                EDERY                                     pedery@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
JUAN                 GARRIDO                                   jgarrido@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
DANIEL               NAVARRO              MONTERO              dnavarro@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
MARINA               DIAZ                 HERNANDO             mdiazhernando@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
ANGELA               OLIVA                JIMIENEZ             aoliva@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
HELENA               ROMAN                PULIDO               hroman@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
ROCIO                MOSQUERA             HERRERO              rmosquera@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
ELENA                MONTOYA              VILLEGAS             emontoya@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
MARIA                OSUNA                GALISTEO             mosuna@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
SERGIO               NAVAS                                     snavas@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
MANUEL               GALLEGO              HERRERA              mgallego@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
ALEJANDRO            ALONSO               ORIHUELA             aalonso@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
JULIA                MARTINEZ             ATIENZA              jatienza@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
LUCIA                ALVAR                ORTEGA               lalvar@gmail.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 

19 filas seleccionadas.

SQL> 
SQL> 
SQL> REM 18 - TODOS LOS SOCIOS QUE ASISTAN A ZUMBA DE LA POBLACIàN 2
SQL> 
SQL> SELECT DISTINCT SOCIOS.* FROM SOCIOS, ASISTIR, CLASES WHERE SOCIOS.N_SOCIO=ASISTIR.N_SOCIO AND ASISTIR.ID_CLASE=CLASES.ID_CLASE AND CLASES.TIPO='ZUMBA' AND SOCIOS.ID_POB=2;

   N_SOCIO DNI       NOMBRE               APELLIDO             SEG_APELLIDO         MAIL                                                                                                 TELEFONO   CALLE                                                  NUMERO         CP     ID_POB                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
---------- --------- -------------------- -------------------- -------------------- ---------------------------------------------------------------------------------------------------- ---------- -------------------------------------------------- ---------- ---------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
         1 Y7451932S TOMAS                VEGA                 ORTEGA               tvega@gmail.com                                                                                      660046009  SUECIA                                                     44      28022          2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         

SQL> 
SQL> 
SQL> SPOOL OFF
